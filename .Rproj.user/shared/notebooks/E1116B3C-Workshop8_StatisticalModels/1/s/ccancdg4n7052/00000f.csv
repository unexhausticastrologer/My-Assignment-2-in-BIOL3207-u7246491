"0","### Multiplying the number of mice by 10!"
"0","n_mice <- n_mice*10"
"0","# mean weight of newborn mouse in grams "
"0","intercept <- 5"
"0","# mean daily increase in mass for females"
"0","female_slope <- 1"
"0","# mean daily increase in mass for males"
"0","male_slope <- 1.4"
"0",""
"0","# let's assume that the treatment reduces the slope of weight gain by 0.5 in both sexes"
"0","delta_treatment_slope <- -0.5"
"0","days <- 14"
"0",""
"0","# standard deviation around means"
"0","noise <- 2"
"0",""
"0","age_sex_trt_df <- tibble(mouse_id = 1:n_mice, age = rpois(n_mice,20), sex = c(rep(""FEMALE"",n_mice/2),rep(""MALE"",n_mice/2)), trt = rep(c(rep(""CONTROL"",n_mice/4),rep(""TREATMENT"",n_mice/4)),2)) %>% mutate(before = ifelse(sex == ""FEMALE"",intercept+age*female_slope,intercept+age*male_slope)) %>% mutate(before = before + rnorm(n_mice,0,noise)) %>% mutate(after = ifelse(trt == ""CONTROL"",ifelse(sex == ""FEMALE"",before+(days*female_slope),before+(days*male_slope)),ifelse(sex == ""FEMALE"",before+(days*(female_slope+delta_treatment_slope)),before+(days*(male_slope+delta_treatment_slope))))) %>% mutate(after = after + rnorm(n_mice,0,noise))"
"0","paired_age_sex_trt_df <- age_sex_trt_df %>% mutate(change_in_mass = after-before)"
"0","lm_paired_age_sex_trt <- lm(change_in_mass ~ age*sex*trt,data = paired_age_sex_trt_df)"
"0","summary(lm_paired_age_sex_trt)"
"1","
Call:
"
"1",""
"1","lm(formula = change_in_mass ~ age * sex * trt, data = paired_age_sex_trt_df)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-6.1019 "
"1","-1.3062 "
"1"," 0.0873 "
"1"," 1.1962 "
"1"," 6.8788 "
"1","
"
"1","
Coefficients:
"
"1","                        "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)             "
"1"," 14.45553"
"1","    0.90234"
"1","  16.020"
"1","  < 2e-16"
"1"," ***"
"1","
age                     "
"1"," -0.02363"
"1","    0.04386"
"1","  -0.539"
"1","    0.590"
"1","    "
"1","
sexMALE                 "
"1","  6.15797"
"1","    1.30359"
"1","   4.724"
"1"," 3.23e-06"
"1"," ***"
"1","
trtTREATMENT            "
"1"," -8.77476"
"1","    1.23352"
"1","  -7.114"
"1"," 5.41e-12"
"1"," ***"
"1","
age:sexMALE             "
"1"," -0.03611"
"1","    0.06354"
"1","  -0.568"
"1","    0.570"
"1","    "
"1","
age:trtTREATMENT        "
"1","  0.08889"
"1","    0.05965"
"1","   1.490"
"1","    0.137"
"1","    "
"1","
sexMALE:trtTREATMENT    "
"1","  1.77583"
"1","    1.78060"
"1","   0.997"
"1","    0.319"
"1","    "
"1","
age:sexMALE:trtTREATMENT"
"1"," -0.07197"
"1","    0.08655"
"1","  -0.832"
"1","    0.406"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","1.999"
"1"," "
"1","on"
"1"," "
"1","392"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8329"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8299"
"1"," "
"1","
F-statistic:"
"1"," "
"1","279.1"
"1"," "
"1","on"
"1"," "
"1","7"
"1"," "
"1","and"
"1"," "
"1","392"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
